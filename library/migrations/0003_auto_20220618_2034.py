# Generated by Django 4.0.5 on 2022-06-18 20:34

from django.db import migrations
from library.constants import FILE_FORMATS, STORAGE_DESTINATIONS


def create_initial_data(apps, schema_editor):
    digitial_library = apps.get_model("library", "DigitalLibrary")
    storage_destination = apps.get_model("library", "StorageDestination")
    record_format_type = apps.get_model("library", "RecordFormatType")
    format_storage_destination = apps.get_model("library", "FormatStorageDestination")

    digitial_library.objects.create(name="DigitalLibrary")
    for destination in STORAGE_DESTINATIONS:
        storage_destination.objects.create(name=destination)

    for file_format in FILE_FORMATS:
        record_format_type.objects.create(name=file_format)

    record_formats = record_format_type.objects.all()
    storage_destination = storage_destination.objects.get(name="local_drive")
    for record_format in record_formats:
        format_storage_destination.objects.create(
            record_format=record_format, storage_destination=storage_destination
        )


class Migration(migrations.Migration):

    dependencies = [
        ("library", "0002_auto_20220618_2027"),
    ]

    operations = [
        migrations.RunPython(create_initial_data, migrations.RunPython.noop),
    ]
